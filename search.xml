<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ambari二次开发分享 (一)</title>
      <link href="/2024/05/29/ambari%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%88%86%E4%BA%AB-%E4%B8%80/"/>
      <url>/2024/05/29/ambari%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%88%86%E4%BA%AB-%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="#ambari%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%86%85%E5%AE%B9%E6%95%B4%E7%90%86">Ambari二次开发内容整理</a><ul><li><a href="#%E6%9E%B6%E6%9E%84">架构</a></li><li><a href="#rpm%E5%8C%85%E8%A7%A3%E5%8E%8B%E5%91%BD%E4%BB%A4">rpm包解压命令</a></li><li><a href="#ambari%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84">ambari目录结构</a><ul><li><a href="#ambari-server">ambari-server</a></li><li><a href="#ambari-agent">ambari-agent</a></li></ul></li><li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%9B%86%E6%88%90%E5%8E%9F%E7%90%86">自定义服务的集成原理</a></li><li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84">自定义服务的项目结构</a></li><li><a href="#metainfoxml%E8%AF%A6%E8%A7%A3">metainfo.xml详解</a><ul><li><a href="#%E8%AF%A6%E7%BB%86%E6%8F%8F%E8%BF%B0">详细描述</a></li></ul></li><li><a href="#configuration%E4%BD%9C%E7%94%A8">configuration作用</a><ul><li><a href="#elastic-configxml">elastic-config.xml</a></li><li><a href="#elastic-envxml">elastic-env.xml</a></li><li><a href="#xml%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3">xml文件详解</a></li><li><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BF%AE%E6%94%B9%E5%90%8E%E6%8F%90%E7%A4%BA%E9%87%8D%E5%90%AF%E6%9C%8D%E5%8A%A1">配置文件修改后提示重启服务</a></li><li><a href="#%E9%85%8D%E7%BD%AE%E7%89%88%E6%9C%AC">配置版本</a></li></ul></li><li><a href="#python%E5%8C%85%E8%AF%A6%E8%A7%A3">Python包详解</a><ul><li><a href="#%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E7%9A%84%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF">获取页面的配置信息</a></li><li><a href="#%E8%8E%B7%E5%8F%96ambari%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF">获取ambari集群配置信息</a><ul><li><a href="#default%E6%96%B9%E6%B3%95%E8%8E%B7%E5%8F%96%E5%B1%9E%E6%80%A7%E5%80%BC">default方法获取属性值</a></li></ul></li><li><a href="#%E9%80%9A%E8%BF%87python%E6%89%A7%E8%A1%8Cshell%E8%AF%AD%E5%8F%A5">通过python执行shell语句</a></li><li><a href="#%E9%80%9A%E8%BF%87python%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%E5%92%8C%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6">通过python创建文件夹和创建文件</a></li><li><a href="#%E9%80%9A%E8%BF%87python%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E5%A4%B9%E5%92%8C%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6">通过python删除文件夹和创建文件</a></li></ul></li><li><a href="#ambari%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9C%8D%E5%8A%A1%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%AE%A1%E7%90%86">ambari自定义服务生命周期管理</a></li><li><a href="#%E9%A1%B5%E9%9D%A2%E4%B8%8A%E6%B7%BB%E5%8A%A0%E4%BF%AE%E6%94%B9%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE">页面上添加修改服务配置</a></li></ul></li></ul><hr><h1 id="Ambari二次开发内容整理"><a href="#Ambari二次开发内容整理" class="headerlink" title="Ambari二次开发内容整理"></a>Ambari二次开发内容整理</h1><h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><p>主从架构，管理动作是从ambari-agent执行组件的start命令</p><h2 id="rpm包解压命令"><a href="#rpm包解压命令" class="headerlink" title="rpm包解压命令"></a>rpm包解压命令</h2><p>rpm2cpio ambari-server-2.7.5.0-72.x86_64.rpm | cpio -div</p><h2 id="ambari目录结构"><a href="#ambari目录结构" class="headerlink" title="ambari目录结构"></a>ambari目录结构</h2><h3 id="ambari-server"><a href="#ambari-server" class="headerlink" title="ambari-server"></a>ambari-server</h3><ol><li>etc:<ul><li>ambari-server的一些配置，init和init.d是ambari-server的启动命令，可以通过这里面的命令实现ambari-server的启动停止等</li></ul></li><li>user：<ul><li>user&#x2F;lib&#x2F;ambari-server&#x2F;web: ambari-server前端的编译后的源码</li><li>user&#x2F;lib&#x2F;ambari-server&#x2F;lib&#x2F;resource-managent: python的公共类库，自定义的python脚本会用到这里面的启动停止方法</li></ul></li><li>var:<ul><li>var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;common-services: 公共服务</li><li>var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks: 会继承公共服务</li><li>var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP: 版本，这里使用的版本是3.1的版本</li><li>var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;services: 很多服务，其他的服务是继承的3.0和上面的版本</li></ul></li><li>最主要的目录：<ul><li>var&#x2F;lib&#x2F;ambari-server&#x2F;resources：自定义服务的存放地址</li><li>user&#x2F;lib&#x2F;ambari-server&#x2F;lib&#x2F;resource-managent：公共类库</li></ul></li></ol><h3 id="ambari-agent"><a href="#ambari-agent" class="headerlink" title="ambari-agent"></a>ambari-agent</h3><ol><li>etc:<ul><li>ambari-agent的一些配置，init和init.d是ambari-agent的启动命令，可以通过这里面的命令实现ambari-agent的启动停止等</li></ul></li><li>user:<ul><li>user&#x2F;lib&#x2F;ambari-server&#x2F;lib&#x2F;resource-managent: python的公共类库，自定义的python脚本会用到这里面的启动停止方法</li></ul></li><li>var:<ul><li>var&#x2F;lib&#x2F;ambari-agent&#x2F;cache&#x2F;common-services: 很多组件服务</li><li>var&#x2F;lib&#x2F;ambari-agent&#x2F;cache&#x2F;stacks&#x2F;HDP: 版本，这里使用的版本是3.1的版本</li></ul></li></ol><h2 id="自定义服务的集成原理"><a href="#自定义服务的集成原理" class="headerlink" title="自定义服务的集成原理"></a>自定义服务的集成原理</h2><ol><li>python脚本开发</li><li>使用resource-managent来完成自定义的集成</li><li>var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks选择和hdp安装的版本，在这里放自定义的项目</li><li>&#x2F;var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;3.1&#x2F;services放入我们自定义的组件内容</li></ol><h2 id="自定义服务的项目结构"><a href="#自定义服务的项目结构" class="headerlink" title="自定义服务的项目结构"></a>自定义服务的项目结构</h2><ol><li>metainfo.xml：重中之重，自定义名称，组件，启动命令使用那个python脚本等</li><li>package：<ul><li>&#x2F;var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;3.1&#x2F;services&#x2F;ES&#x2F;package&#x2F;scripts:存放python脚本和模板</li><li>&#x2F;var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;3.1&#x2F;services&#x2F;ES&#x2F;configuration:比如让用户在前端界面可视化的控制配置，在这里创建xml文件，里面都是k，v的形式</li><li>&#x2F;var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;3.1&#x2F;services&#x2F;ES&#x2F;quicklinks：json文件约束</li><li>&#x2F;var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;3.1&#x2F;services&#x2F;ES&#x2F;thems：每个配置的前端样式，都是json文件约束的</li><li>&#x2F;var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;3.1&#x2F;services&#x2F;ES&#x2F;alerts.json：配置告警</li><li>&#x2F;var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;3.1&#x2F;services&#x2F;ES&#x2F;mertics.json:监控指标</li><li>&#x2F;var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;3.1&#x2F;services&#x2F;ES&#x2F;widgeys.json:监控指标</li><li>&#x2F;var&#x2F;lib&#x2F;ambari-server&#x2F;resources&#x2F;stacks&#x2F;HDP&#x2F;3.1&#x2F;services&#x2F;ES&#x2F;role_command_order.json：HDP的顺序的约束配置就是通过这个json来实现的</li></ul></li></ol><hr><h2 id="metainfo-xml详解"><a href="#metainfo-xml详解" class="headerlink" title="metainfo.xml详解"></a>metainfo.xml详解</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">metainfo</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">schemaVersion</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">schemaVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">services</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">service</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 名称 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>ELASTICSEARCH<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- ambari添加服务列表中对应的 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">displayName</span>&gt;</span>Elasticsearch<span class="tag">&lt;/<span class="name">displayName</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">comment</span>&gt;</span>Elasticsearch是一个基于Lucene的搜索服务。它提供了一个基于RESTful web接口的分布式多用户全文检索引擎。<span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 组件的相关信息 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">components</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">component</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>ELASTICSEARCH_SERVICE<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- ambariWeb页面上显示的服务名称 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">displayName</span>&gt;</span>Elasticsearch Service<span class="tag">&lt;/<span class="name">displayName</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- 组件的类别，MASTER、SLAVE、CLIENT --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">category</span>&gt;</span>MASTER<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cardinality</span>&gt;</span>1+<span class="tag">&lt;/<span class="name">cardinality</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">timelineAppid</span>&gt;</span>elasticsearch<span class="tag">&lt;/<span class="name">timelineAppid</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- 服务主程序 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">script</span>&gt;</span>scripts/master.py<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">scriptType</span>&gt;</span>PYTHON<span class="tag">&lt;/<span class="name">scriptType</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">timeout</span>&gt;</span>1800<span class="tag">&lt;/<span class="name">timeout</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">customCommands</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">customCommand</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">name</span>&gt;</span>test_master_check<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">background</span>&gt;</span>true<span class="tag">&lt;/<span class="name">background</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">script</span>&gt;</span>scripts/master.py<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">scriptType</span>&gt;</span>PYTHON<span class="tag">&lt;/<span class="name">scriptType</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">customCommand</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">customCommands</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">component</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>ELASTICSEARCH_HEAD<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">displayName</span>&gt;</span>Elasticsearch Head<span class="tag">&lt;/<span class="name">displayName</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">category</span>&gt;</span>MASTER<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cardinality</span>&gt;</span>1<span class="tag">&lt;/<span class="name">cardinality</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">timelineAppid</span>&gt;</span>elasticsearch<span class="tag">&lt;/<span class="name">timelineAppid</span>&gt;</span>o</span><br><span class="line">                    <span class="tag">&lt;<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">script</span>&gt;</span>scripts/head.py<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">scriptType</span>&gt;</span>PYTHON<span class="tag">&lt;/<span class="name">scriptType</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">timeout</span>&gt;</span>1800<span class="tag">&lt;/<span class="name">timeout</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">customCommands</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">customCommand</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">name</span>&gt;</span>test_head_check<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">background</span>&gt;</span>true<span class="tag">&lt;/<span class="name">background</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">script</span>&gt;</span>scripts/head.py<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">scriptType</span>&gt;</span>PYTHON<span class="tag">&lt;/<span class="name">scriptType</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">customCommand</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">customCommands</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">component</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>ELASTICSEARCH_CLIENT<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">displayName</span>&gt;</span>ELASTICSEARCH Client<span class="tag">&lt;/<span class="name">displayName</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">category</span>&gt;</span>CLIENT<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cardinality</span>&gt;</span>1+<span class="tag">&lt;/<span class="name">cardinality</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">versionAdvertised</span>&gt;</span>true<span class="tag">&lt;/<span class="name">versionAdvertised</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">script</span>&gt;</span>scripts/elasticsearch_client.py<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">scriptType</span>&gt;</span>PYTHON<span class="tag">&lt;/<span class="name">scriptType</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- 下载操作，用户可以下载这个配置文件 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configFiles</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">configFile</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">type</span>&gt;</span>xml<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">fileName</span>&gt;</span>elastic-config.xml<span class="tag">&lt;/<span class="name">fileName</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">dictionaryName</span>&gt;</span>elastic-config<span class="tag">&lt;/<span class="name">dictionaryName</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">configFile</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">configFile</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">type</span>&gt;</span>xml<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">fileName</span>&gt;</span>elastic-env.xml<span class="tag">&lt;/<span class="name">fileName</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">dictionaryName</span>&gt;</span>elastic-env<span class="tag">&lt;/<span class="name">dictionaryName</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">configFile</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">configFile</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">type</span>&gt;</span>env<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">fileName</span>&gt;</span>elasticsearch.yml<span class="tag">&lt;/<span class="name">fileName</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">dictionaryName</span>&gt;</span>elastic-config<span class="tag">&lt;/<span class="name">dictionaryName</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">configFile</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">configFile</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">type</span>&gt;</span>properties<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">fileName</span>&gt;</span>elastic-env.conf<span class="tag">&lt;/<span class="name">fileName</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">dictionaryName</span>&gt;</span>elastic-env<span class="tag">&lt;/<span class="name">dictionaryName</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">configFile</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configFiles</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- 这个放在这里表示的是当修改了elastic-env命令后会重启这个ELASTICSEARCH_CLIENT组件，而不是整个服务的重启 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                    &lt;configuration-dependencies&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                        &lt;config-type&gt;elastic-env&lt;/config-type&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                        &lt;config-type&gt;elastic-config&lt;/config-type&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                    &lt;/configuration-dependencies&gt;--&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">components</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 运行文件检查 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">commandScript</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">script</span>&gt;</span>scripts/service_check.py<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scriptType</span>&gt;</span>PYTHON<span class="tag">&lt;/<span class="name">scriptType</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">timeout</span>&gt;</span>1800<span class="tag">&lt;/<span class="name">timeout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">commandScript</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">osSpecifics</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">osSpecific</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">osFamily</span>&gt;</span>any<span class="tag">&lt;/<span class="name">osFamily</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">osSpecific</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">osSpecifics</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--            &lt;configuration-dir&gt;configuration-mapred&lt;/configuration-dir&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 当xml文件中内容在前端修改之后点击保存后，会有一个重启按钮 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 这个放在这里表示的是当修改了elastic-env和elastic-config后会重启整个服务，对应configuration目录下内容 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration-dependencies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">config-type</span>&gt;</span>elastic-env<span class="tag">&lt;/<span class="name">config-type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">config-type</span>&gt;</span>elastic-config<span class="tag">&lt;/<span class="name">config-type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration-dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- 只使用theme_elasticsearch_version_4.json这个文件的前端主题样式 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">themes-dir</span>&gt;</span>themes<span class="tag">&lt;/<span class="name">themes-dir</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">themes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">theme</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">fileName</span>&gt;</span>theme_elasticsearch_version_4.json<span class="tag">&lt;/<span class="name">fileName</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">default</span>&gt;</span>true<span class="tag">&lt;/<span class="name">default</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">theme</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">themes</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--            &lt;quickLinksConfigurations-dir&gt;quicklinks-mapred&lt;/quickLinksConfigurations-dir&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 设置quicklinks --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">quickLinksConfigurations</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">quickLinksConfiguration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">fileName</span>&gt;</span>quicklinks-es.json<span class="tag">&lt;/<span class="name">fileName</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">default</span>&gt;</span>true<span class="tag">&lt;/<span class="name">default</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">quickLinksConfiguration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">quickLinksConfigurations</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--需要前置安装的服务，随便举的例子，假设Elasticsearch服务依赖zookeeper服务--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;requiredServices&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                &lt;service&gt;ZOOKEEPER&lt;/service&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;/requiredServices&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">services</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">metainfo</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="详细描述"><a href="#详细描述" class="headerlink" title="详细描述"></a>详细描述</h3><ol><li>描述服务 &lt;service&gt; 的字段包括</li></ol><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>name</td><td>服务名，必须唯一，建议大写</td></tr><tr><td>displayName</td><td>服务在 web UI 上的显示名</td></tr><tr><td>comment</td><td>服务的描述信息</td></tr><tr><td>version</td><td>服务版本，用 name 和 version 唯一标记一个服务</td></tr><tr><td>components</td><td>服务中包含的组件</td></tr><tr><td>commandScript（可选)</td><td>自定义命令 python 脚本入口，如果一个 Service 的 metainfo.xml 有该字段，那么在 Service 的 Action 列表中就会出现自定义命令。</td></tr><tr><td>requiredServices（可选）</td><td>集群上强制依赖的其他服务。换句话说，安装当前服务之前，必须安装 requiredServices 内指定的服务。</td></tr><tr><td>configuration-dependencies（可选）</td><td>服务依赖的 xml 文件，当在前端页面上修改 xml 文件内容后并保存配置，服务会提示重启，服务下的所有组件都将被重启。</td></tr><tr><td>quickLinksConfigurations（可选）</td><td>自定义快速链接，通常在这里设置服务 web UI 链接。</td></tr><tr><td>osSpecifics（可选）</td><td>服务会根据操作系统的差异来选择不同的 rpm 包</td></tr><tr><td>themes（可选）</td><td>指定主题配置，通常和 json 文件相关联。</td></tr></tbody></table><ol start="2"><li>service&#x2F;components – 一个服务包含几个组件</li></ol><table><thead><tr><th>属性</th><th>说明</th></tr></thead><tbody><tr><td>name</td><td>组件名</td></tr><tr><td>displayName</td><td>组件的显示名</td></tr><tr><td>category</td><td>指定了该组件（Component）的类别，可以是 MASTER、SLAVE、CLIENT。</td></tr><tr><td>commandScript</td><td>标准命令，调用 python 脚本，用来执行该组件的某些操作</td></tr><tr><td>cardinality</td><td>指的是所要安装的机器数，可以是固定数字 1，可以是一个范围比如 1-2，也可以是 1+、0+、ALL 或者是一个范围，进行服务安装向导的时候会限制选择的机器数。</td></tr><tr><td>versionAdvertised（可选）</td><td>是否宣称版本，用于回滚和升级</td></tr><tr><td>timelineAppid（可选）</td><td>存储 metric 数据的默认类型</td></tr><tr><td>configuration-dependencies（可选）</td><td>组件依赖的 xml 文件，当在前端页面上修改 xml 文件内容后并保存配置，服务会提示重启，只有该组件将被重启。</td></tr><tr><td>customCommands（可选）</td><td>标准命令之外自定义的命令</td></tr><tr><td>configFiles（可选）</td><td>客户端配置可以下载的配置文件</td></tr><tr><td>3. service&#x2F;component&#x2F;customCommand - 添加到组件的自定义命令</td><td></td></tr></tbody></table><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>name</td><td>自定义命令名称</td></tr><tr><td>commandScript</td><td>实现自定义命令的脚本</td></tr><tr><td>commandScript&#x2F;script</td><td>脚本路径</td></tr><tr><td>commandScript&#x2F;scriptType（可选）</td><td>脚本类型，目前只支持 python</td></tr><tr><td>commandScript&#x2F;timeout（可选）</td><td>自定义命令超时时间</td></tr><tr><td>4. service&#x2F;component&#x2F;configFiles – 客户端配置可以下载的配置文件</td><td></td></tr></tbody></table><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>type</td><td>下载文件类型, xml, env, sh, yaml, etc</td></tr><tr><td>fileName</td><td>下载的文件文件名</td></tr><tr><td>dictionary</td><td>包含配置属性的数据字典</td></tr></tbody></table><ol start="5"><li>service&#x2F;osSpecifics - 操作系统特定包名 rpm 包</li></ol><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>osSpecific&#x2F;osFamily</td><td>rpm 包适用的操作系统</td></tr><tr><td>osSpecific&#x2F;packages&#x2F;package&#x2F;name</td><td>部署服务需要的包名，将执行 <code>yum install xxx</code> 命令</td></tr></tbody></table><ol start="6"><li>service&#x2F;quickLinksConfigurations</li></ol><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>service&#x2F;quickLinksConfigurations-dir</td><td>可选字段。用于告诉 Ambari Server 在哪里加载 xxx.json 文件。如果我们希望服务使用默认的 quicklinks 目录，则可以跳过它。</td></tr><tr><td>service&#x2F;quickLinksConfigurations&#x2F;quickLinksConfiguration&#x2F;fileName</td><td>json 文件，指定的 quickLink 文件名称</td></tr><tr><td>service&#x2F;quickLinksConfigurations&#x2F;quickLinksConfiguration&#x2F;default</td><td>一般为 true</td></tr></tbody></table><ol start="7"><li>service&#x2F;configuration-dependencies</li></ol><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>service&#x2F;configuration-dir</td><td>可选字段。用于告诉 Ambari Server 在哪里加载 xxx.xml 文件。如果我们希望服务使用默认的 configuration 目录，则可以跳过它。</td></tr><tr><td>service&#x2F;configuration-dependencies&#x2F;config-type</td><td>服务依赖的配置文件名称。如果在前端页面上修改了该 xml 文件内容后并保存配置，服务会提示重启，整个服务都将被重启。</td></tr></tbody></table><ol start="8"><li>service&#x2F;themes</li></ol><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>service&#x2F;themes-dir</td><td>可选字段。用于告诉 Ambari Server 在哪里加载 xxx.json 文件。如果我们希望服务使用默认的 themes 目录，则可以跳过它。</td></tr><tr><td>service&#x2F;themes&#x2F;theme&#x2F;fileName</td><td>json 文件，指定的主题文件名称</td></tr><tr><td>service&#x2F;themes&#x2F;theme&#x2F;default</td><td>一般为 true</td></tr></tbody></table><h2 id="configuration作用"><a href="#configuration作用" class="headerlink" title="configuration作用"></a>configuration作用</h2><p>xml中的文件都会在configuration目录下，xml文件中的大部分的属性都会在web ui的configs下展示</p><p>xml 被 Ambari Server 加载之后，在前端页面上会出现两个配置项，分别是 高级选项 和 自定义选项。其中 高级选项 里面就是 xml 文件的内容，自定义选项 可以加入自定义配置信息，如果不需要显示自定义配置信息的话，可以通过添加 &lt;configuration supports_adding_forbidden&#x3D;”true”&gt; 来隐藏掉自定义配置信息。</p><h3 id="elastic-config-xml"><a href="#elastic-config-xml" class="headerlink" title="elastic-config.xml"></a>elastic-config.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">supports_adding_forbidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 下面每个Property就是一行 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Cluster --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>cluster_name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>集群名称<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span><span class="comment">&lt;!-- 前端页面显示的值 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>elasticsearch<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Elasticsearch集群名称<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置项锁定，服务安装后不可以编辑 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;value-attributes&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;editable-only-at-install&gt;true&lt;/editable-only-at-install&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/value-attributes&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Node --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>node_attr_rack<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Node attr rack<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/default-rack<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Add custom attributes to the node<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 允许这个配置的值为空 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;value-attributes&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;empty-value-valid&gt;true&lt;/empty-value-valid&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/value-attributes&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Paths --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>path_data<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Path data<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/elasticsearch/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Path to directory where to store the data (separate multiple directory by comma)<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">final</span>&gt;</span>true<span class="tag">&lt;/<span class="name">final</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>directories<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;overridable&gt;false&lt;/overridable&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">on-ambari-upgrade</span> <span class="attr">add</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Memory --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>bootstrap_memory_lock<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Bootstrap memory lock<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Whether memory is locked on elasticsearch startup<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">overridable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">overridable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>value-list<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entries</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>ON<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>OFF<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">entries</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">selection-cardinality</span>&gt;</span>1<span class="tag">&lt;/<span class="name">selection-cardinality</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>bootstrap_system_call_filter<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Bootstrap system call filter<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Whether check SecComp on elasticsearch startup<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">overridable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">overridable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>value-list<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entries</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>ON<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>OFF<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">entries</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">selection-cardinality</span>&gt;</span>1<span class="tag">&lt;/<span class="name">selection-cardinality</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Network --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;name&gt;network_host&lt;/name&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;value&gt;&#123;&#123;hostname&#125;&#125;&lt;/value&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;description&gt;Set the bind address to a specific IP (IPv4 or IPv6)&lt;/description&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/property&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>elasticsearch_port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Elasticsearch port<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>9200<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Elasticsearch port<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>elasticsearch_head_port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Elasticsearch head port<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>9100<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Elasticsearch head port<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>content<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Elasticsearch config file template<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>This is the template for elasticsearch.yml file<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line"># ======================== Elasticsearch Configuration =========================</span><br><span class="line">#</span><br><span class="line"># NOTE: Elasticsearch comes with reasonable defaults for most settings.</span><br><span class="line"># Before you set out to tweak and tune the configuration, make sure you</span><br><span class="line"># understand what are you trying to accomplish and the consequences.</span><br><span class="line">#</span><br><span class="line"># The primary way of configuring a node is via this file. This template lists</span><br><span class="line"># the most important settings you may want to configure for a production cluster.</span><br><span class="line">#</span><br><span class="line"># Please see the documentation for further information on configuration options:</span><br><span class="line"></span><br><span class="line"># ---------------------------------- Cluster -----------------------------------</span><br><span class="line"># Use a descriptive name for your cluster:</span><br><span class="line">cluster.name: &#123;&#123;cluster_name&#125;&#125;</span><br><span class="line"></span><br><span class="line"># ------------------------------------ Node ------------------------------------</span><br><span class="line"># Use a descriptive name for the node:</span><br><span class="line">node.name: &#123;&#123;hostname&#125;&#125;</span><br><span class="line"></span><br><span class="line"># Add custom attributes to the node:</span><br><span class="line">node.attr.rack: &#123;&#123;node_attr_rack&#125;&#125;</span><br><span class="line"></span><br><span class="line"># ----------------------------------- Paths ------------------------------------</span><br><span class="line"># Path to directory where to store the data (separate multiple locations by comma):</span><br><span class="line">path.data: &#123;&#123;path_data&#125;&#125;</span><br><span class="line"></span><br><span class="line"># Path to log files:</span><br><span class="line">path.logs: &#123;&#123;elastic_log_dir&#125;&#125;</span><br><span class="line"></span><br><span class="line"># ----------------------------------- Memory -----------------------------------</span><br><span class="line">#</span><br><span class="line"># Lock the memory on startup:</span><br><span class="line">#</span><br><span class="line">bootstrap.memory_lock: &#123;&#123;bootstrap_memory_lock&#125;&#125;</span><br><span class="line"></span><br><span class="line"># ---------------------------------- Network -----------------------------------</span><br><span class="line"># Set the bind address to a specific IP (IPv4 or IPv6):</span><br><span class="line">network.host: &#123;&#123;hostname&#125;&#125;</span><br><span class="line"></span><br><span class="line"># Set a custom port for HTTP:</span><br><span class="line">http.port: &#123;&#123;elasticsearch_port&#125;&#125;</span><br><span class="line">transport.tcp.port: 9300</span><br><span class="line"></span><br><span class="line"># ----------------------------------- Head Requires -----------------------------------</span><br><span class="line">http.cors.enabled: &#123;&#123;http_cors_enabled&#125;&#125;</span><br><span class="line">http.cors.allow-origin: &quot;&#123;&#123;http_cors_allow_origin&#125;&#125;&quot;</span><br><span class="line"># --------------------------------- Discovery ----------------------------------</span><br><span class="line"># Pass an initial list of hosts to perform discovery when new node is started:</span><br><span class="line"># The default list of hosts is [&quot;127.0.0.1&quot;, &quot;[::1]&quot;]</span><br><span class="line">discovery.zen.ping.unicast.hosts: &#123;&#123;discovery_zen_ping_unicast_hosts&#125;&#125;</span><br><span class="line"></span><br><span class="line"># Prevent the &quot;split brain&quot; by configuring the majority of nodes (total number of nodes / 2 + 1):</span><br><span class="line">discovery.zen.minimum_master_nodes: &#123;&#123;discovery_zen_minimum_master_nodes&#125;&#125;</span><br><span class="line"></span><br><span class="line"># ---------------------------------- Gateway -----------------------------------</span><br><span class="line">#</span><br><span class="line"># Block initial recovery after a full cluster restart until N nodes are started:</span><br><span class="line">#</span><br><span class="line">gateway.recover_after_nodes: &#123;&#123;gateway_recover_after_nodes&#125;&#125;</span><br><span class="line">#</span><br><span class="line"># For more information, consult the gateway module documentation.</span><br><span class="line">#</span><br><span class="line"># ---------------------------------- Various 123-----------------------------------</span><br><span class="line">#</span><br><span class="line"># Require explicit names when deleting indices:</span><br><span class="line">#</span><br><span class="line">action.destructive_requires_name: &#123;&#123;action_destructive_requires_name&#125;&#125;</span><br><span class="line">&#123;% if ping_timeout_default %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% else %&#125;</span><br><span class="line">discovery.zen.ping_timeout: &#123;&#123;discovery_zen_ping_timeout&#125;&#125;s</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>content<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">show-property-name</span>&gt;</span>true<span class="tag">&lt;/<span class="name">show-property-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">on-ambari-upgrade</span> <span class="attr">add</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Discovery --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;name&gt;discovery_zen_ping_unicast_hosts&lt;/name&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;value&gt;&lt;/value&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;description&gt;Pass an initial list of hosts to perform discovery when new node is started&lt;/description&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/property&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&lt;property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;name&gt;discovery_zen_minimum_master_nodes&lt;/name&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;value&gt;1&lt;/value&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;description&gt;Prevent the &quot;split brain&quot; by configuring the majority of nodes (total number of nodes / 2 + 1)&lt;/description&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/property&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Head Requires --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>http_cors_enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Http cors enabled<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Whether to support cross-domain<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">overridable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">overridable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>value-list<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entries</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>ON<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>OFF<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">entries</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">selection-cardinality</span>&gt;</span>1<span class="tag">&lt;/<span class="name">selection-cardinality</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>http_cors_allow_origin<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Http cors allow origin<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Allow cross-domain, default is &quot;*&quot;, indicating support for all domain names.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&lt;property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;name&gt;http.cors.allow-headers&lt;/name&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;value&gt;&quot;Authorization&quot;&lt;/value&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;description&gt;X-pack authorization&lt;/description&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/property&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Gateway --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>gateway_recover_after_nodes<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Gateway recover after nodes<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Allow Initialization Recovery after N Nodes Start<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">final</span>&gt;</span>true<span class="tag">&lt;/<span class="name">final</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>int<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">minimum</span>&gt;</span>0<span class="tag">&lt;/<span class="name">minimum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maximum</span>&gt;</span>6<span class="tag">&lt;/<span class="name">maximum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">increment-step</span>&gt;</span>1<span class="tag">&lt;/<span class="name">increment-step</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Various --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>node_max_local_storage_nodes<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Node max local storage nodes<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Set the number of elasticsearch nodes that a machine can run, usually using the default of 1.</span><br><span class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">final</span>&gt;</span>true<span class="tag">&lt;/<span class="name">final</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>int<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">minimum</span>&gt;</span>0<span class="tag">&lt;/<span class="name">minimum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maximum</span>&gt;</span>6<span class="tag">&lt;/<span class="name">maximum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">increment-step</span>&gt;</span>1<span class="tag">&lt;/<span class="name">increment-step</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">on-ambari-upgrade</span> <span class="attr">add</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--index.number_of_replicas--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>discovery_zen_ping_timeout<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>discovery.zen.ping.timeout<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>discovery zen ping timeout<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>int<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">minimum</span>&gt;</span>1<span class="tag">&lt;/<span class="name">minimum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maximum</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maximum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">increment-step</span>&gt;</span>1<span class="tag">&lt;/<span class="name">increment-step</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">on-ambari-upgrade</span> <span class="attr">add</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>ping_timeout_default<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>ping timeout default<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>...<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">overridable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">overridable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>value-list<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entries</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>ON<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>OFF<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">entries</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">selection-cardinality</span>&gt;</span>1<span class="tag">&lt;/<span class="name">selection-cardinality</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>action_destructive_requires_name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Action destructive requires name<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>When deleting an index, do you need to specify a name explicitly? When the value is false, it can</span><br><span class="line">            be deleted by regular or _all.</span><br><span class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">overridable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">overridable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>value-list<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entries</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>ON<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>OFF<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">entries</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">selection-cardinality</span>&gt;</span>1<span class="tag">&lt;/<span class="name">selection-cardinality</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">on-ambari-upgrade</span> <span class="attr">add</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>es.head.http.policy<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>HTTP_ONLY<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">            This configures the HTTP endpoint for Elasticsearch Head Daemons.The following values are supported: -</span><br><span class="line">            HTTP_ONLY : Service is provided only on http - HTTPS_ONLY : Service is provided only on https</span><br><span class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>zookeeper.session.timeout<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>90000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>ZooKeeper session timeout.</span><br><span class="line">            ZooKeeper session timeout in milliseconds. It is used in two different ways.</span><br><span class="line">            First, this value is used in the ZK client that HBase uses to connect to the ensemble.</span><br><span class="line">            It is also used by HBase when it starts a ZK server and it is passed as the &#x27;maxSessionTimeout&#x27;. See</span><br><span class="line">            http://hadoop.apache.org/zookeeper/docs/current/zookeeperProgrammers.html#ch_zkSessions.</span><br><span class="line">            For example, if a HBase region server connects to a ZK ensemble that&#x27;s also managed by HBase, then the</span><br><span class="line">            session timeout will be the one specified by this configuration. But, a region server that connects</span><br><span class="line">            to an ensemble managed with a different configuration will be subjected that ensemble&#x27;s maxSessionTimeout.</span><br><span class="line">            So,</span><br><span class="line">            even though HBase might propose using 90 seconds, the ensemble can have a max timeout lower than this and</span><br><span class="line">            it will take precedence.</span><br><span class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Zookeeper Session Timeout<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>int<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">minimum</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">minimum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maximum</span>&gt;</span>180000<span class="tag">&lt;/<span class="name">maximum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">unit</span>&gt;</span>milliseconds<span class="tag">&lt;/<span class="name">unit</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">increment-step</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">increment-step</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">on-ambari-upgrade</span> <span class="attr">add</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.hregion.majorcompaction<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Time between major compactions, expressed in milliseconds. Set to 0 to disable</span><br><span class="line">            time-based automatic major compactions. User-requested and size-based major compactions will</span><br><span class="line">            still run. This value is multiplied by hbase.hregion.majorcompaction.jitter to cause</span><br><span class="line">            compaction to start at a somewhat-random time during a given window of time. The default value</span><br><span class="line">            is 7 days, expressed in milliseconds. If major compactions are causing disruption in your</span><br><span class="line">            environment, you can configure them to run at off-peak times for your deployment, or disable</span><br><span class="line">            time-based major compactions by setting this parameter to 0, and run major compactions in a</span><br><span class="line">            cron job or by another external mechanism.</span><br><span class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Major Compaction Interval<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>int<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">minimum</span>&gt;</span>0<span class="tag">&lt;/<span class="name">minimum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maximum</span>&gt;</span>2592000000<span class="tag">&lt;/<span class="name">maximum</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">unit</span>&gt;</span>milliseconds<span class="tag">&lt;/<span class="name">unit</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">on-ambari-upgrade</span> <span class="attr">add</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="elastic-env-xml"><a href="#elastic-env-xml" class="headerlink" title="elastic-env.xml"></a>elastic-env.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">   Licensed to the Apache Software Foundation (ASF) under one or more</span></span><br><span class="line"><span class="comment">   contributor license agreements.  See the NOTICE file distributed with</span></span><br><span class="line"><span class="comment">   this work for additional information regarding copyright ownership.</span></span><br><span class="line"><span class="comment">   The ASF licenses this file to You under the Apache License, Version 2.0</span></span><br><span class="line"><span class="comment">   (the &quot;License&quot;); you may not use this file except in compliance with</span></span><br><span class="line"><span class="comment">   the License.  You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment">       http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment">   Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment">   distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment">   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment">   See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment">   limitations under the License.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">supports_adding_forbidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 自动创建用户和用户组 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>elastic_user<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Elasticsearch user<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>es<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Elasticsearch user<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property-type</span>&gt;</span>USER<span class="tag">&lt;/<span class="name">property-type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>user<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">overridable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">overridable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">user-groups</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- 指定这个用户属于哪个用户组 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">type</span>&gt;</span>cluster-env<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>user_group<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">type</span>&gt;</span>elastic-env<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>es_group<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">user-groups</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>es_group<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>es User Group<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>elasticsearch_group<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property-type</span>&gt;</span>GROUP<span class="tag">&lt;/<span class="name">property-type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>es user group.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>elastic_log_dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Elasticsearch log directory<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/var/log/elasticsearch<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Elasticsearch log directory<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>elastic_pid_dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Elasticsearch pid directory<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/var/run/elasticsearch<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Elasticsearch pid directory<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>elastic_head_pid_dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Elasticsearch Head pid directory<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/var/run/elasticsearch-head<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Elasticsearch Head pid directory<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="xml文件详解"><a href="#xml文件详解" class="headerlink" title="xml文件详解"></a>xml文件详解</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- Cluster --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>cluster_name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Cluster name<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>elasticsearch<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Elasticsearch cluster name<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&lt;property&gt; 下属性解释说明：</p><ul><li>name：属性名称。当无 display-name 属性时，name 值将会显示在前端页面上。</li><li>display-name：前端页面显示的名称，会覆盖显示在前端页面上的 name 值。</li><li>value：属性值。前端页面对应 输入框 里面的值，可修改并保存。</li><li>description：属性描述信息。在前端页面上以鼠标悬浮框的形式显示出来。</li></ul><ol><li><p>配置项锁定（服务安装后不可编辑）：</p><p> 在 <property> 标签内添加：</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">editable-only-at-install</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable-only-at-install</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>允许字段值为空（默认情况下，字段值为空在安装页面会告警提示）：</p><p>在 <property> 标签内添加：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">empty-value-valid</span>&gt;</span>true<span class="tag">&lt;/<span class="name">empty-value-valid</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>密码校验</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">require-input</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>kadmin.local.password<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>admin password<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property-type</span>&gt;</span>PASSWORD<span class="tag">&lt;/<span class="name">property-type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>The password is used to add the kerberos database administrator<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">type</span>&gt;</span>password<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>switch 开关</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hue-hdfs-module-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>Yes<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Hue HDFS Module<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Enable Hue Filebrower Module<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">overridable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">overridable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">type</span>&gt;</span>value-list<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entries</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Yes<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span>&gt;</span>ON<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>No<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span>&gt;</span>OFF<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entries</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">selection-cardinality</span>&gt;</span>1<span class="tag">&lt;/<span class="name">selection-cardinality</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/image.png" alt="alt text"></p></li><li><p>开关量</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>kyuubi.ha.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">type</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>这是属性描述<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="/images/image-1.png" alt="alt text"></p><ol start="6"><li><p>去除自定义配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">supports_adding_forbidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>显示配置名称</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 默认为input输入框，当type为content时，即为文本框 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">type</span>&gt;</span>content<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 是否显示配置名称 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">show-property-name</span>&gt;</span>true<span class="tag">&lt;/<span class="name">show-property-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>目录类型</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 默认为目录输入框 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">type</span>&gt;</span>directories<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>自动创建用户和用户组</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>elastic_user<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Elasticsearch user<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>es<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Elasticsearch user<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property-type</span>&gt;</span>USER<span class="tag">&lt;/<span class="name">property-type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value-attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">type</span>&gt;</span>user<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">user-groups</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>cluster-env<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>user_group<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>elastic-env<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>es_group<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">user-groups</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">value-attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>es_group<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>es User Group<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>elasticsearch_group<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property-type</span>&gt;</span>GROUP<span class="tag">&lt;/<span class="name">property-type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>es user group.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样设置的话，会创建名为 es 的用户，并归属于 hadoop 和 elasticseaech_group 用户组。</p></li></ol><h3 id="配置文件修改后提示重启服务"><a href="#配置文件修改后提示重启服务" class="headerlink" title="配置文件修改后提示重启服务"></a>配置文件修改后提示重启服务</h3> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">metainfo</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">schemaVersion</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">schemaVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">services</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">service</span>&gt;</span></span><br><span class="line">            ...(省略)</span><br><span class="line">            </span><br><span class="line">            <span class="tag">&lt;<span class="name">components</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">component</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>ELASTICSEARCH_SERVICE<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">displayName</span>&gt;</span>Elasticsearch Service<span class="tag">&lt;/<span class="name">displayName</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">category</span>&gt;</span>MASTER<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cardinality</span>&gt;</span>1+<span class="tag">&lt;/<span class="name">cardinality</span>&gt;</span></span><br><span class="line">                    ...(省略)</span><br><span class="line">                    </span><br><span class="line">                    <span class="tag">&lt;<span class="name">configuration-dir</span>&gt;</span>configuration<span class="tag">&lt;/<span class="name">configuration-dir</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configuration-dependencies</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">config-type</span>&gt;</span>elastic-config<span class="tag">&lt;/<span class="name">config-type</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configuration-dependencies</span>&gt;</span></span><br><span class="line">                    </span><br><span class="line">                    ...(省略)</span><br><span class="line">                <span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">components</span>&gt;</span>      </span><br><span class="line">            </span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration-dir</span>&gt;</span>configuration<span class="tag">&lt;/<span class="name">configuration-dir</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration-dependencies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">config-type</span>&gt;</span>elastic-env<span class="tag">&lt;/<span class="name">config-type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration-dependencies</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">            ...(省略)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">services</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">metainfo</span>&gt;</span></span><br></pre></td></tr></table></figure><p> 详情查看前面的示例，分为整个服务重启和单个组件重启两种方式</p><h3 id="配置版本"><a href="#配置版本" class="headerlink" title="配置版本"></a>配置版本</h3><p>配置修改记录会保存到 ambari 数据库中，主要涉及到的表有：</p><ul><li>serviceconfig</li><li>serviceconfigmapping</li><li>clusterconfig（历史配置的详细内容）</li></ul><p>用于查看历史版本，回溯历史版本version</p><h2 id="Python包详解"><a href="#Python包详解" class="headerlink" title="Python包详解"></a>Python包详解</h2><p>开头都会引入resource_management中的类库<br>这个类库的位置在ambari-server和ambari-agent的lib目录下都有：</p><ul><li>ambari-server&#x2F;lib&#x2F;resource_management&#x2F;</li><li>ambari-agent&#x2F;lib&#x2F;resource_management&#x2F;</li></ul><p>可以获取自定义服务页面上的配置信息和ambari集群的相关配置信息，使用python执行shell语句，使用python创建删除文件夹和文件</p><p>在 Ambari web 页面上，我们打开 自定义服务 的 配置 页面，会发现上面显示的配置和 configuration 下的 xml 文件内容是一致的</p><h3 id="获取页面的配置信息"><a href="#获取页面的配置信息" class="headerlink" title="获取页面的配置信息"></a>获取页面的配置信息</h3><p>使用Script.get_config()获取configuration目录下的里面的xml文件名里面的一个property的name就可以获取到value值了</p><p><img src="/images/image-2.png" alt="alt text"></p><h3 id="获取ambari集群配置信息"><a href="#获取ambari集群配置信息" class="headerlink" title="获取ambari集群配置信息"></a>获取ambari集群配置信息</h3><p>通过ambariLevelParams的java_home获取当前版本</p><p>通过get_ambari_properties的hostname获取主机名<br>….</p><p>这里有个缺点，如果要获取的配置不存在的话程序就会报错，我们可以换个友好的获取属性值的方法。</p><h4 id="default方法获取属性值"><a href="#default方法获取属性值" class="headerlink" title="default方法获取属性值"></a>default方法获取属性值</h4><p>更加安全的方法获取属性值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> resource_management.libraries.functions.default <span class="keyword">import</span> default</span><br></pre></td></tr></table></figure><p><img src="/images/image-3.png" alt="alt text"></p><p><img src="/images/image-4.png" alt="alt text"></p><h3 id="通过python执行shell语句"><a href="#通过python执行shell语句" class="headerlink" title="通过python执行shell语句"></a>通过python执行shell语句</h3><p>Execute</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> resource_management.core.resources.system <span class="keyword">import</span> Execute</span><br></pre></td></tr></table></figure><p><img src="/images/image-5.png" alt="alt text"></p><p>Execute方法还可以指定执行用户以及失败后是否忽略</p><p><img src="/images/image-6.png" alt="alt text"></p><h3 id="通过python创建文件夹和创建文件"><a href="#通过python创建文件夹和创建文件" class="headerlink" title="通过python创建文件夹和创建文件"></a>通过python创建文件夹和创建文件</h3><p><img src="/images/image-7.png" alt="alt text"></p><h3 id="通过python删除文件夹和创建文件"><a href="#通过python删除文件夹和创建文件" class="headerlink" title="通过python删除文件夹和创建文件"></a>通过python删除文件夹和创建文件</h3><p><img src="/images/image-8.png" alt="alt text"></p><h2 id="ambari自定义服务生命周期管理"><a href="#ambari自定义服务生命周期管理" class="headerlink" title="ambari自定义服务生命周期管理"></a>ambari自定义服务生命周期管理</h2><p>在Add service中添加服务可以对服务的默认值进行修改，也可以在安装后的configs标签后对服务进行更改</p><p>包括，启动停止重启安装卸载监听等</p><p>在metainfo.xml中的component标签下面有commandScript，指定了组件运行时候使用的python文件</p><p><img src="/images/image-9.png" alt="alt text"></p><ul><li><p>安装install():</p><p>ambari2.6需要在这个install中添加创建用户的命令，而ambari2.7不需要，ambari2.7在configuration的目录下的xml文件属性中设进行添加</p></li><li><p>配置configure():</p><p>这个方法没有被ambari默认触发，而是在install，start，restart方法里面调用，主要是执行配置，创建相关目录，设置目录的用户组和用户，更改服务配置使用</p></li><li><p>启动start():</p><p>会调用configure()启动服务</p></li><li><p>停止stop():</p></li><li><p>监听status():</p><p>使用ambari的resource_management中的check_process_status判断服务状态<br>也就是监测一个pid文件里面的进程号是不是当前正在运行的进程号来监测启动状态</p><p><img src="/images/image-10.png" alt="alt text"></p><p>status_params.py文件中的内容是<br><img src="/images/image-11.png" alt="alt text"></p></li><li><p>重启restart():</p><p>当文件没有restart方法会先执行stop再执行start，当有restart方法时，会直接执行restart方法</p></li><li><p>卸载</p><p>ambari的卸载没有方法，有一张叫 clusterservices 的表，里面存放着已安装服务的相关数据。<br>删除应用就是删除这个表中的内容，只是做了逻辑删除并没有真正的删除，目录还是一直在的</p></li></ul><h2 id="页面上添加修改服务配置"><a href="#页面上添加修改服务配置" class="headerlink" title="页面上添加修改服务配置"></a>页面上添加修改服务配置</h2>]]></content>
      
      
      <categories>
          
          <category> 二次开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ambari </tag>
            
            <tag> 二次开发 </tag>
            
            <tag> 源码解析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/05/29/hello-world/"/>
      <url>/2024/05/29/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
